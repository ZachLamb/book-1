<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
      <script src="https://cdn.firebase.com/js/client/2.3.2/firebase.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.0.0/lodash.min.js"></script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCvjx2rX763ezVHsvdemCY3Fc3vBtsEygo&signed_in=true"></script>
    <script>
// In the following example, markers appear when the user clicks on the map.
// Each marker is labeled with a single alphabetical character.
var labels = '12345';
var labelIndex = 0;

function initialize() {
  var boulder =  {lat:40.018420740127205 ,lng: -105.27825951576233};
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 12,
    center: boulder
  });

  // This event listener calls addMarker() when the map is clicked.
  google.maps.event.addListener(map, 'click', function(event) {
    addMarker(event.latLng, map);
  });

  // Add a marker at the center of the map.
  addMarker(boulder, map);
}

// Adds a marker to the map.
function addMarker(location, map) {
  // Add the marker at the clicked location, and add the next-available label
  // from the array of alphabetical characters.
  var marker = new google.maps.Marker({
    position: location,
    label: labels[labelIndex++ % labels.length],
    map: map
  });
}

google.maps.event.addDomListener(window, 'load', initialize);

    </script>
    <title>Bar Crawl</title>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 75%;
        width: 75%;
      }
    </style>
  </head>
  <body>
  <nav class="black">
        <div class="nav-wrapper">
            <a href="#" class="brand-logo center">
              Bar Crawl Planning
            </a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
            <ul id="nav-mobile" class="left hide-on-med-and-down">
                <li><a href="index.html">Home</a></li>
                <li><a href="map.html">Map</a></li>
                <li><a href="group.html">Group</a></li>
                <li><a href="login.html">Login</a></li>
            </ul>
            <ul class="side-nav" id="mobile-demo">
                <li><a href="index.html">Home</a></li>
                <li><a href="map.html">Map</a></li>
                <li><a href="group.html">Group</a></li>
                <li><a href="login.html">Login</a></li>
            </ul>
        </div>
    </nav>
    <br>
     <div class="container" id="map"></div>
     <div class="container"><a href="#!" id = "QtGrp" class="waves-effect waves-light btn modal-trigger black yellow-text">Quit Group</a></div>
  <script>
    $('.button-collapse').sideNav({
      menuWidth: 300, // Default is 240
      edge: 'left', // Choose the horizontal origin
      closeOnClick: true // Closes side-nav on <a> clicks, useful for Angular/Meteor
    }
  );
   $( "#QtGrp" ).click(function() {
	var usrName = "Scotty Me";
console.log('leave', usrName)

    var groupID;

	var ref2 = new Firebase('https://drinktogether.firebaseio.com/users/'+usrName+'/groupID/');
		console.log('URL: ', 'https://drinktogether.firebaseio.com/users/'+usrName+'/groupID/')
	ref2.on('value', function(snapshot){
		var ID = snapshot.val();
		groupID = ID;
		console.log('Leaving: ', groupID)
    		var ref3 = new Firebase('https://drinktogether.firebaseio.com/groups/id/' + groupID + '/listOfUsers/');
		console.log('Person: ', 'https://drinktogether.firebaseio.com/groups/id/' + groupID + '/listOfUsers/')
    		var onComplete2 = function(error) {
       		 if (error) {
          			  console.log('Leave Synchronization failed');
       			 } else {
            				console.log('Leave Synchronization succeeded');
        	}
    };
    ref3.child(usrName).remove(onComplete2);

		var ref2 = new Firebase('https://drinktogether.firebaseio.com/users/'+usrName);
    		ref2.once('value', function(snapshot){
		        var user = snapshot.val();
			ref2.set({
        		lat: user.lat,
        		lon: user.lon,
        		name: user.name,
        		isGroupOwner: 'False',
			groupID: "000",
    		});
		})




	});
   });
  </script>   
  </body>
</html>
